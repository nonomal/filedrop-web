# Nginx configuration example

More details are available here: https://www.nginx.com/blog/websocket-nginx/

Replace `DOMAIN_NAME` with your domain name.

> [!WARNING]
> To use HTTP/3 your nginx must be built with HTTP/3 support.
> To check if your installation of nginx supports HTTP/3 execute `nginx -V` and check for presence of `--with-http_v3_module`.

```nginx
# ...

http {
  # BEGIN: HTTP/2 setup
    http2 on;
  # END: HTTP/2 setup

  # BEGIN: HTTP/3 setup
    # Feel free to leave this out if not using HTTP/3 or already configured.

    http3 on;
    http3_hq on;
    quic_gso on;
    quic_retry on;
  # END: HTTP/3 setup

  upstream filedrop {
    server 127.0.0.1:5000; # 5000 = PORT
  }

  map $http_upgrade $connection_upgrade {
    default upgrade;
    '' close;
  }

  # ...

  server {
    server_name DOMAIN_NAME;

    listen 443 ssl;
    listen [::]:443 ssl;

    # BEGIN: HTTP/3 (QUIC) setup
      # Feel free to leave this out if not using HTTP/3.

      listen 443 quic;
      listen [::]:443 quic;
      add_header Alt-Svc 'h3=":443"; ma=86400';
      add_header x-quic 'h3';
      add_header Alt-Svc 'h3-29=":443"; ma=86400';
      add_header Alt-Svc 'quic=":443"; ma=86400';
    # END: HTTP/3 (QUIC) setup

    # BEGIN: SSL certificate
      # The following lines will be most likely generated by certbot/Let's Encrypt.
      # You may choose to omit them if using certbot.

      ssl_certificate /path/to/fullchain.pem;
      ssl_certificate_key /path/to/privkey.pem;
      # ...
      ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;
    # END: SSL certificate

    # ...

    location / {
      proxy_pass http://filedrop;
      proxy_http_version 1.1;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header Host $host;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection $connection_upgrade;
    }

    # BEGIN: Caching
      location ~* \.(jpg|jpeg|gif|png|svg|bin|img|js|css|woff|woff2|webp)$ {
        proxy_pass http://filedrop;
        proxy_http_version 1.1;
        proxy_cache mycache;
        proxy_cache_min_uses 1;
        proxy_cache_valid 200 302 1d;
        proxy_cache_valid 404 1h;
        expires 12M;
        add_header Cache-Control "public immutable";
        add_header X-Cache-Status $upstream_cache_status;
      }
    # END: Caching
  }

  server {
    if ($host = DOMAIN_NAME) {
      return 301 https://$host$request_uri;
    }


    listen 80;
    listen [::]:80;

    server_name DOMAIN_NAME;
    return 404;
  }
}
```
